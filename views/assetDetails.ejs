<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CoinRates - Detailed Coin View</title>
  
  <!-- Tailwind CSS (CDN) -->
  <script src="https://cdn.tailwindcss.com" defer></script>
  <!-- Lucide Icons (optional for icons) -->
  <script src="https://unpkg.com/lucide@latest" defer></script>

  <style>
    /* Ensure the flex container respects vertical overflow */
    .flex-container {
      min-height: 0;
    }
    /* Dropdown styles for Account */
    .account-dropdown {
      position: absolute;
      right: 0;
      top: 100%;
      background: #1C2530;
      border-radius: 0.375rem;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      z-index: 10;
      min-width: 160px;
      display: none;
    }
    .account-dropdown a {
      display: block;
      padding: 0.5rem 1rem;
      text-decoration: none;
      color: white;
    }
    .account-dropdown a:hover {
      background-color: #2A3340;
    }
  </style>
</head>
<body class="bg-[#0B0E14] text-white min-h-screen flex flex-col">

  <!-- NAVIGATION BAR -->
  <nav class="bg-[#131A24]">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="flex h-16 items-center justify-between">
        <!-- Logo and Branding -->
        <div class="flex items-center space-x-2">
          <img src="./assets/logo.png" alt="CoinRates Logo" class="w-10 h-10 rounded-full"/>
          <span class="hidden sm:block font-bold text-xl">CoinRates</span>
        </div>
        <!-- Desktop Navigation Links -->
        <div class="hidden sm:flex flex-1 justify-center space-x-6">
          <a href="dashboard-2.html" class="text-gray-300 hover:text-white transition flex items-center space-x-1">
            <i data-lucide="bar-chart" class="w-5 h-5"></i>
            <span>My Dashboard</span>
          </a>
          <a href="#" class="text-gray-300 hover:text-white transition flex items-center space-x-1">
            <i data-lucide="refresh-cw" class="w-5 h-5"></i>
            <span>Quick Convert</span>
          </a>
        </div>
        <!-- Account/Profile Section with Dropdown -->
        <div class="relative flex items-center space-x-2">
          <span class="hidden md:block">Hi, Filip</span>
          <button id="account-btn" type="button" class="relative flex rounded-full bg-[#131A24] p-1 text-gray-400 hover:text-white focus:ring-2 focus:ring-white">
            <img src="https://via.placeholder.com/40" alt="Profile" class="w-10 h-10 rounded-full"/>
          </button>
          <!-- Account Dropdown -->
          <div id="account-dropdown" class="account-dropdown">
            <a href="myProfile.html">My Profile</a>
            <a href="#" id="logout-btn">Log Out</a>
          </div>
        </div>
        <!-- Mobile Menu Button (Hamburger) -->
        <button type="button" id="menu-toggle" aria-expanded="false" class="sm:hidden ml-2 p-2 text-gray-400 hover:bg-gray-700 hover:text-white focus:ring-2 focus:ring-white">
          <i data-lucide="menu" class="w-6 h-6"></i>
        </button>
      </div>
    </div>
    <!-- Mobile Menu (hidden by default) -->
    <div class="sm:hidden hidden" id="mobile-menu">
      <div class="space-y-2 px-4 pt-4 pb-3">
        <a href="#" class="flex items-center space-x-2 rounded-md px-4 py-2 text-base font-medium text-gray-300 hover:bg-gray-700 hover:text-white">
          <i data-lucide="bar-chart" class="w-5 h-5"></i>
          <span>My Dashboard</span>
        </a>
        <a href="dashboard-2.html" class="flex items-center space-x-2 rounded-md px-4 py-2 text-base font-medium text-gray-300 hover:bg-gray-700 hover:text-white">
          <i data-lucide="refresh-cw" class="w-5 h-5"></i>
          <span>Quick Convert</span>
        </a>
        <a href="#" class="flex items-center space-x-2 rounded-md px-4 py-2 text-base font-medium text-gray-300 hover:bg-gray-700 hover:text-white">
          <i data-lucide="user" class="w-5 h-5"></i>
          <span>Account</span>
        </a>
      </div>
    </div>
  </nav>

  <!-- MAIN CONTENT: 3 COLUMNS WITH DIVIDERS -->
  <div class="flex-1 flex flex-container overflow-hidden" style="min-height: 0;">
    <!-- Left Column (Assets Overview) -->
    <aside id="leftColumn" class="bg-[#131A24] p-4 overflow-y-auto" style="flex: 1;">
      <h2 class="text-lg font-bold mb-4">Assets Overview</h2>
      <ul class="space-y-3">
        <!-- Example asset -->
        <li class="bg-[#1C2530] p-3 rounded-md flex items-center space-x-3">
          <img src="./assets/btc-icon.png" alt="BTC Icon" class="w-8 h-8"/>
          <div class="flex-1">
            <p class="font-semibold">BTC</p>
            <p class="text-sm text-gray-400">0.85 BTC</p>
            <p class="text-sm">$20,400</p>
          </div>
          <span class="text-green-500 text-sm font-semibold">+5.2%</span>
        </li>
        <!-- Repeat for other cryptos -->
      </ul>
    </aside>

    <!-- Vertical Divider between Left and Central Columns -->
    <div class="hidden lg:block w-px bg-gray-700 mx-2"></div>

    <!-- Central Column (Coin Detail) -->
    <section id="coinDetailColumn" class="bg-[#1C2530] p-4 overflow-y-auto transition-all duration-500" style="flex: 3;">
      <!-- Top layout in 3 columns on md+ screens -->
      <div class="flex flex-col md:flex-row md:items-start md:justify-between space-y-4 md:space-y-0">
        <!-- Column 1: Coin Information -->
        <div class="md:w-1/3 md:pr-4">
          <h2 id="coinName" class="text-2xl font-bold">Bitcoin (BTC)</h2>
          <p id="coinOwned" class="mt-1 text-lg font-semibold">2.40 BTC</p>
          <p>Current Value: <span id="coinValue" class="text-lg">$200,000</span></p>
          <!-- 24h change + sparkline -->
          <div class="flex items-center space-x-2 mt-2">
            <span class="text-green-500 font-semibold">+3.2%</span>
            <img src="./assets/sparkline.png" alt="24h Sparkline Chart" class="h-6"/>
          </div>
        </div>
        <!-- Column 2: Pie Chart -->
        <div class="md:w-1/3 md:pr-4 flex justify-center">
          <div class="w-32 h-32">
            <img src="./assets/piechart.png" alt="Coin Pie Chart" class="w-full h-full object-contain"/>
          </div>
        </div>
        <!-- Column 3: Add Transaction Button -->
        <div class="md:w-1/3 flex items-center justify-center">
          <button id="addTransactionBtn" class="border border-gray-500 text-gray-500 hover:bg-gray-500 hover:text-white transition px-3 py-2 rounded-md font-medium text-sm shadow-sm">
            Add Transaction
          </button>
        </div>
      </div>
      <!-- Lower block: Line Chart (Price History) -->
      <div class="bg-[#1C2530] p-4 rounded-md mt-6">
        <h3 class="text-lg font-semibold mb-2">BTC Price History</h3>
        <div id="coinLineChartContainer" class="h-64">
          <img src="./assets/linechart.png" alt="BTC Price Chart" class="w-full h-full object-contain"/>
        </div>
      </div>
    </section>

    <!-- Vertical Divider between Central and Right Columns -->
    <div class="hidden lg:block w-px bg-gray-700 mx-2"></div>

    <!-- Right Column (Transaction History) -->
    <section id="transactionColumn" class="bg-[#1C2530] p-4 relative overflow-y-auto transition-all duration-500" style="flex: 2;">
      <div class="flex justify-between items-center">
        <h2 id="coinTxHistoryTitle" class="text-lg font-bold mb-4">BTC Transaction History</h2>
        <!-- Expansion Button (icon) -->
        <button id="toggleTableBtn" class="p-2 text-white hover:text-gray-300 focus:outline-none">
          <svg id="toggleIcon" class="w-6 h-6 transition-transform duration-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6l8 8 8-8"/>
          </svg>
        </button>
      </div>
      <div id="tableContainer" class="overflow-hidden transition-all duration-500 ease-in-out">
        <table id="transactionTable" class="table-auto border-collapse text-xs text-gray-300 bg-[#131A24] border-separate border-spacing-y-2 whitespace-nowrap w-full">
          <thead class="bg-[#1C2530]">
            <tr>
              <th class="py-3 px-3 border text-center">Date</th>
              <th class="py-3 px-3 border text-center">Pair</th>
              <th class="py-3 px-3 border text-center">Type</th>
              <th class="py-3 px-3 border text-center">Price</th>
              <th class="py-3 px-3 border text-center">Amount</th>
              <th class="py-3 px-3 border text-center">Total</th>
              <th class="py-3 px-3 border text-center">Current Price</th>
              <th class="py-3 px-3 border text-center">P/L(%)</th>
              <th class="py-3 px-3 border w-24 text-center">Action</th>
            </tr>
          </thead>
          <tbody id="transactionTableBody">
            <tr class="border-b border-gray-600 bg-[#131A24]">
              <td class="py-3 px-3 border text-center">2025-03-01</td>
              <td class="py-3 px-3 border text-center">BTC/USDT</td>
              <td class="py-3 px-3 border text-center text-red-500">Sell</td>
              <td class="py-3 px-3 border text-center">$100,000</td>
              <td class="py-3 px-3 border text-center">0.05 BTC</td>
              <td class="py-3 px-3 border text-center">$5,000</td>
              <td class="py-3 px-3 border text-center">$6,500</td>
              <td class="py-3 px-3 border text-center text-green-500">+30%</td>
              <td class="py-3 px-3 border w-24 text-center">
                <div class="flex justify-center space-x-1">
                  <button class="bg-gray-600 hover:bg-gray-500 px-2 py-1 rounded">Modify</button>
                  <button class="bg-red-600 hover:bg-red-500 px-2 py-1 rounded">Delete</button>
                </div>
              </td>
            </tr>
            <!-- More rows if needed -->
          </tbody>
        </table>
      </div>
    </section>
  </div>

  <!-- EXPANSION SCRIPT (for Transaction History) -->
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const toggleButton = document.getElementById("toggleTableBtn");
      const toggleIcon = document.getElementById("toggleIcon");
      const transactionColumn = document.getElementById("transactionColumn");
      const coinDetailColumn = document.getElementById("coinDetailColumn");
      
      let expanded = false;
      
      toggleButton.addEventListener("click", function() {
        expanded = !expanded;
        if(expanded) {
          // Hide the coin detail column and expand the transactions column
          coinDetailColumn.classList.add("hidden");
          transactionColumn.style.flex = "4";
          toggleIcon.style.transform = "rotate(180deg)";
        } else {
          // Show the coin detail column and restore the original proportion
          coinDetailColumn.classList.remove("hidden");
          transactionColumn.style.flex = "2";
          toggleIcon.style.transform = "rotate(0deg)";
        }
      });
    });
  </script>

  <!-- MOBILE MENU SCRIPT -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      if (typeof lucide !== "undefined") {
        lucide.createIcons();
      }
      const menuButton = document.getElementById("menu-toggle");
      const mobileMenu = document.getElementById("mobile-menu");
      menuButton.addEventListener("click", function () {
        const expanded = this.getAttribute("aria-expanded") === "true";
        this.setAttribute("aria-expanded", !expanded);
        mobileMenu.classList.toggle("hidden");
      });
    });
  </script>

  <!-- Script for "Add Transaction" redirection -->
  <script>
    document.getElementById("addTransactionBtn").addEventListener("click", function () {
      window.location.href = "addTransaction.html"; 
    });
  </script>

  <!-- Account Dropdown Script -->
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const accountBtn = document.getElementById("account-btn");
      const accountDropdown = document.getElementById("account-dropdown");

      accountBtn.addEventListener("click", function(e) {
        e.stopPropagation();
        accountDropdown.style.display = accountDropdown.style.display === "block" ? "none" : "block";
      });

      // Hide dropdown when clicking outside
      document.addEventListener("click", function(e) {
        if (!accountBtn.contains(e.target) && !accountDropdown.contains(e.target)) {
          accountDropdown.style.display = "none";
        }
      });

      // Logout button functionality
      document.getElementById("logout-btn").addEventListener("click", function(e) {
        e.preventDefault();
        localStorage.removeItem("loggedIn"); // Simulated logout
        window.location.href = "home-2.html"; // Redirect to home page
      });
    });
  </script>
</body>
</html>